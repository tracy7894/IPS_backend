# --- IG è¨­å®šï¼ˆåƒè€ƒç”¨ï¼‰ ---
ig:
profiles:
patient: "https://twcore.mohw.gov.tw/ig/twcore/StructureDefinition/Patient-twcore"

# --- ä¾†æºè·¯ç”±ï¼ˆæŠŠåŸå§‹è³‡æ–™çš„å“ªä¸€æ®µï¼Œåšæˆå“ªç¨® FHIR è³‡æºï¼‰ ---


type_router:
  # ç—…æ‚£è³‡æ–™ â†’ Patient
  - source: "$.ç—…æ‚£æ¸…å–®[*]"
    make: "Patient"
    fields:
      identifier:
        - system: "urn:oid:1.2.886.4.6.1.1.999"
          value: "$.èº«åˆ†è­‰è™Ÿ"
      name:
        - use: "official"   # TW Core IG è¦å®šå¿…å¡«
          text: "$.å§“å"
          family: "$.å§“"
          given: "$.å"
      gender: "$.æ€§åˆ¥"
      birthDate: "$.å‡ºç”Ÿæ—¥æœŸ"

      # ğŸ“ è¯çµ¡è³‡è¨Š (telecom)
      telecom:
        - system: "$.è¯çµ¡æ–¹å¼.ç³»çµ±"
          value: "$.è¯çµ¡æ–¹å¼.å€¼"
          use: "$.è¯çµ¡æ–¹å¼.ç”¨é€”"
          rank: "$.è¯çµ¡æ–¹å¼.æ’åº"

      # ğŸ  åœ°å€
      address:
        - use: "home"
          type: "both"
          country: "$.åœ°å€.åœ‹å®¶"
          line: "$.åœ°å€.è©³ç´°"
          city: "$.åœ°å€.ç¸£å¸‚"
          district: "$.åœ°å€.é„‰é®å€"   # TW Core å¿…å¡«
          text: "å¾…å¾Œç«¯è™•ç†"
          postalCode: "$.åœ°å€.éƒµéå€è™Ÿ"

      # âš™ï¸ å…¶ä»–ç‹€æ…‹
      active: "$.æ˜¯å¦æœ‰æ•ˆ"
      maritalStatus: "$.å©šå§»ç‹€æ…‹"
      deceasedBoolean: "$.æ˜¯å¦æ­»äº¡"
      deceasedDateTime: "$.æ­»äº¡æ—¥æœŸ"

      # ğŸš¨ ç·Šæ€¥è¯çµ¡äºº å¯åˆª
      contact:
        - relationship:
          - coding:
            - system: "http://terminology.hl7.org/CodeSystem/v2-0131"
              code: "$.ç·Šæ€¥è¯çµ¡äºº.é—œä¿‚"        
          name:
            use: "official"
            text: "$.ç·Šæ€¥è¯çµ¡äºº.å§“å"
            family: "$.ç·Šæ€¥è¯çµ¡äºº.å§“"
            given: "$.ç·Šæ€¥è¯çµ¡äºº.å"
          telecom:
            - system: "$.ç·Šæ€¥è¯çµ¡äºº.è¯çµ¡æ–¹å¼.ç³»çµ±"
              value: "$.ç·Šæ€¥è¯çµ¡äºº.è¯çµ¡æ–¹å¼.å€¼"
              use: "$.ç·Šæ€¥è¯çµ¡äºº.è¯çµ¡æ–¹å¼.ç”¨é€”"
          address:
            use: "home"
            type: "both"
            country: "$.ç·Šæ€¥è¯çµ¡äºº.åœ°å€.åœ‹å®¶"
            line: "$.ç·Šæ€¥è¯çµ¡äºº.åœ°å€.è©³ç´°"
            city: "$.ç·Šæ€¥è¯çµ¡äºº.åœ°å€.ç¸£å¸‚"
            district: "$.ç·Šæ€¥è¯çµ¡äºº.åœ°å€.é„‰é®å€"   # TW Core å¿…å¡«
            postalCode: "$.ç·Šæ€¥è¯çµ¡äºº.åœ°å€.éƒµéå€è™Ÿ"
          gender: "$.ç·Šæ€¥è¯çµ¡äºº.æ€§åˆ¥"
          organization: "$.ç·Šæ€¥è¯çµ¡äºº.æ‰€å±¬å–®ä½"
 # ğŸ—£ï¸ èªè¨€èˆ‡æºé€šåå¥½ å¯åˆª
      communication:
        - language:
            coding:
              - system: "urn:ietf:bcp:47"
                code: "$.èªè¨€.ä»£ç¢¼"
                display: "$.èªè¨€.åç¨±"

      # ğŸ¥ ç®¡ç†æ©Ÿæ§‹. ç¢ºèª
      managingOrganization:
        reference: "Organization/$.æ‰€å±¬æ©Ÿæ§‹.id"
        display: "$.æ‰€å±¬æ©Ÿæ§‹.åç¨±"

      # ğŸ–¼ï¸ ç…§ç‰‡
      photo:
        - contentType: "$.ç…§ç‰‡.æ ¼å¼"
          url: "$.ç…§ç‰‡.url"
          title: "$.ç…§ç‰‡.èªªæ˜"
          creation: "$.ç…§ç‰‡.å»ºç«‹æ—¥æœŸ"

# --- è¼¸å‡ºåˆ†çµ„ï¼ˆæ±ºå®šç”¢å‡ºå¹¾å€‹ FLASH æª”ï¼‰ ---
output_groups:
  - name: "åŸºç¤è³‡æº"
    filename: "foundation.flash"
    resources: ["Patient"]